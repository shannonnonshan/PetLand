<form action="/owner/updateStaff/{{staff._id}}" method="POST">
    <div>
        <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
        <input type="text" id="username" name="username" value="{{staff.username}}" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-yellow-400 focus:border-yellow-400">
    </div>

    <div>
        <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
        <input type="text" id="name" name="name" value="{{staff.name}}" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-yellow-400 focus:border-yellow-400">
    </div>

    <div>
        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="email" name="email" value="{{staff.email}}" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-yellow-400 focus:border-yellow-400">
    </div>

    <div>
        <label for="phone" class="block text-sm font-medium text-gray-700">Phone</label>
        <input type="text" id="phone" name="phone" value="{{staff.phone}}" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-yellow-400 focus:border-yellow-400">
    </div>

    <div>
        <label for="gender" class="block text-sm font-medium text-gray-700">Gender</label>
        <select id="gender" name="gender"
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-yellow-400 focus:border-yellow-400">
            <option value="none" {{#if (eq staff.gender "none")}}selected{{/if}}>Prefer not to say</option>
            <option value="Male" {{#if (eq staff.gender "Male")}}selected{{/if}}>Male</option>
            <option value="Female" {{#if (eq staff.gender "Female")}}selected{{/if}}>Female</option>
        </select>
    </div>

    <div class="pt-4">
        <button type="submit"
            class="w-full bg-yellow-400 hover:bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg transition duration-300">
            Update
        </button>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('updateStaffForm');

  form.addEventListener('submit', async function (e) {
    const formData = new FormData(form);
    const id = "{{staff._id}}";

    try {
      const response = await fetch(`/owner/updateStaff/${id}`, {
        method: 'POST',
        body: formData,
      });

      const data = await response.json();

      if (response.ok && data.success) {
        window.location.href = `/staff/${id}`;
      } else {
        alert(data.message || 'Failed to update staff.');
      }
    } catch (error) {
      console.error('Update request failed:', error);
      alert('An error occurred while updating staff.');
    }
  });
});

</script>
